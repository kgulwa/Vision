<div class="max-w-6xl mx-auto px-4 py-10 grid grid-cols-1 md:grid-cols-2 gap-10">

  <!-- LEFT SIDE: PIN IMAGE -->
  <div class="flex justify-center">
    <%= image_tag url_for(@pin.image), class: "rounded-xl shadow-lg max-w-full" %>
  </div>

  <!-- RIGHT SIDE: DETAILS -->
  <div>

    <!-- USER + TITLE -->
    <div class="flex items-center space-x-3 mb-6">
      <div class="w-10 h-10 rounded-full bg-blue-500 text-white flex items-center justify-center">
        <%= @pin.user.username.first.upcase %>
      </div>
      <div>
        <h2 class="font-semibold text-gray-800"><%= @pin.user.username %></h2>
        <p class="text-gray-500 text-sm">New Post</p>
      </div>
    </div>

    <!-- ACTION BUTTONS: LIKE / COMMENT / REPOST -->
    <div class="flex items-center space-x-4 mb-8">
      <% if current_user.liked?(@pin) %>
        <%= button_to pin_like_path(@pin), method: :delete, class: "flex items-center space-x-2 border px-4 py-2 rounded-full" do %>
          üíî
          <span><%= @pin.likes.count %></span>
        <% end %>
      <% else %>
        <%= button_to pin_like_path(@pin), method: :post, class: "flex items-center space-x-2 border px-4 py-2 rounded-full" do %>
          ‚ù§Ô∏è
          <span><%= @pin.likes.count %></span>
        <% end %>
      <% end %>

      <%= link_to "#comments_section", class: "flex items-center space-x-2 border px-4 py-2 rounded-full" do %>
        üí¨
        <span><%= @pin.comments.count %></span>
      <% end %>

      <% if current_user.reposts.exists?(pin: @pin) %>
        <%= button_to pin_repost_path(@pin), method: :delete, class: "flex items-center space-x-2 border px-4 py-2 rounded-full" do %>
          üîÑ
          <span><%= @pin.reposts.count %></span>
        <% end %>
      <% else %>
        <%= button_to pin_repost_path(@pin), method: :post, class: "flex items-center space-x-2 border px-4 py-2 rounded-full" do %>
          üîÅ
          <span><%= @pin.reposts.count %></span>
        <% end %>
      <% end %>

      <!-- EDIT / DELETE PIN BUTTONS -->
      <% if current_user == @pin.user %>
        <%= link_to "Edit Pin", edit_pin_path(@pin), class: "px-3 py-1 bg-blue-100 text-blue-600 rounded hover:bg-blue-200 text-sm" %>
        <%= button_to "Delete Pin", pin_path(@pin), method: :delete, data: { confirm: "Are you sure?" }, class: "px-3 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200 text-sm" %>
      <% end %>
    </div>

    <!-- COMMENTS SECTION -->
    <div id="comments_section">
      <h2 class="text-lg font-semibold mb-4">Comments</h2>

      <!-- COMMENT FORM -->
      <div class="border rounded-lg p-4 mb-6">
        <%= form_with(model: [@pin, Comment.new], local: true) do |form| %>
          <%= form.text_area :content, rows: 3, class: "w-full border rounded-lg p-2", placeholder: "Add a comment..." %>
          <div class="mt-3 flex justify-end">
            <%= form.submit "Post Comment", class: "bg-black text-white px-4 py-2 rounded-lg" %>
          </div>
        <% end %>
      </div>

      <!-- LIST OF COMMENTS -->
      <div class="space-y-4">
        <% @pin.comments.each do |comment| %>
          <div class="p-3 border rounded-lg bg-gray-50 flex justify-between items-start">
            <p>
              <strong><%= comment.user.username %>:</strong>
              <%= comment.content %>
            </p>

            <% if current_user == comment.user %>
              <div class="flex space-x-2">
                <%= link_to "Edit", edit_pin_comment_path(@pin, comment), class: "text-blue-600 text-sm" %>
                <%= button_to "Delete", pin_comment_path(@pin, comment), method: :delete, data: { confirm: "Delete this comment?" }, class: "text-red-600 text-sm" %>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>

    </div>

  </div>
</div>
