<div class="break-inside-avoid mb-4 rounded-xl overflow-hidden shadow-sm hover:shadow-lg transition bg-white">
  <%= link_to pin_path(pin), class: "block relative group" do %>
    
    

    <% if pin.file&.attached? %>
      <%= image_tag url_for(pin.file), class: "w-full h-auto object-cover rounded-t-xl" %>
    <% else %>
      <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
        <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
      </div>
    <% end %>

    <!-- HOVER OVERLAY (UNCHANGED except no save button here) -->
    <div class="absolute inset-0 bg-black bg-opacity-40 opacity-0 group-hover:opacity-100
                transition flex items-center justify-center space-x-6 text-white text-lg font-semibold">
      <span>â¤ï¸ <%= pin.likes.count %></span>
      <span>ğŸ’¬ <%= pin.comments.count %></span>
      <span>ğŸ” <%= pin.reposts.count %></span>
    </div>

  <% end %>

  <div class="p-4">
    <h3 class="font-semibold text-gray-800 mb-1"><%= pin.title %></h3>

    <p class="text-gray-500 text-xs mb-2">
      Posted by
      <%= link_to user_path(pin.user), class: "font-medium text-gray-800 hover:underline" do %>
        <%= pin.user&.username || "Deleted User" %>
      <% end %>

      <span id="explore_follower_count_<%= pin.user.uid.delete('-') %>" class="text-gray-500 text-xs ml-1">
        (<%= pin.user.followers.count %>)
      </span>

      <% if logged_in? && current_user != pin.user %>
        <%= render "users/follow_button", user: pin.user, page: "explore" %>
      <% end %>
    </p>

    <% if current_user == pin.user %>
      <div class="flex space-x-2 mb-2">
        <%= link_to "Edit", edit_pin_path(pin), class: "px-2 py-1 bg-blue-100 text-blue-600 rounded text-sm" %>
        <%= button_to "Delete", pin_path(pin), method: :delete,
              data: { confirm: "Are you sure?" },
              class: "px-2 py-1 bg-red-100 text-red-600 rounded text-sm" %>
      </div>
    <% end %>

    <!-- ALWAYS-VISIBLE ACTION ROW -->
    <div class="flex items-center space-x-4 text-sm text-gray-600">

      <span>â¤ï¸ <%= pin.likes.count %></span>
      <span>ğŸ’¬ <%= pin.comments.count %></span>
      <span>ğŸ” <%= pin.reposts.count %></span>

      <!-- â­ ALWAYS VISIBLE SAVE ICON -->
      <button 
        type="button"
        class="text-gray-700 text-lg hover:text-blue-600"
        data-controller="save-modal"
        data-action="click->save-modal#open"
        data-save-modal-pin-id="<%= pin.id %>">
        ğŸ“Œ Save
      </button>

    </div>
  </div>

  <!-- SAVE MODAL -->
  <%= render "pins/save_modal", pin: pin %>

</div>
